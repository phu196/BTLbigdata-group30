apiVersion: platform.confluent.io/v1beta1
kind: KRaftController
metadata:
  name: kraftcontroller
  namespace: confluent
spec:
  dataVolumeCapacity: 10G
  image:
    application: docker.io/confluentinc/cp-server:8.1.0
    init: confluentinc/confluent-init-container:3.1.0
  replicas: 1
  podTemplate:
    resources:
      requests:
        cpu: "300m"
        memory: "1.5Gi"
      limits:
        cpu: "500m"
        memory: "2Gi"
  configOverrides:
    jvm:
      - "-Xms1g"
      - "-Xmx1g"
  dependencies:
    metricsClient:
      url: http://controlcenter.confluent.svc.cluster.local:9090
---
apiVersion: platform.confluent.io/v1beta1
kind: Kafka
metadata:
  name: kafka
  namespace: confluent
spec:
  replicas: 1
  podTemplate:
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
      limits:
        cpu: "1"
        memory: "3Gi"
  configOverrides:
    jvm:
      - "-Xms1G"
      - "-Xmx1G"
  image:
    application: confluentinc/cp-server:8.1.0
    init: confluentinc/confluent-init-container:3.1.0
  dataVolumeCapacity: 100Gi
  dependencies:
    kRaftController:
      clusterRef:
        name: kraftcontroller
    metricsClient:
      url: http://controlcenter.confluent.svc.cluster.local:9090
---
apiVersion: platform.confluent.io/v1beta1
kind: Connect
metadata:
  name: connect
  namespace: confluent
spec:
  replicas: 1
  podTemplate:
    resources:
      requests:
        cpu: "500m"
        memory: "1.5Gi"
      limits:
        cpu: "1"
        memory: "2Gi"
  configOverrides:
    jvm:
      - "-Xms1g"
      - "-Xmx1g"
  image:
    application: confluentinc/cp-server-connect:8.1.0
    init: confluentinc/confluent-init-container:3.1.0
  build:
    type: onDemand
    onDemand:
      plugins:
        locationType: url
        url:
          - name: debezium-postgres-connector 
            archivePath: https://repo1.maven.org/maven2/io/debezium/debezium-connector-postgres/3.3.1.Final/debezium-connector-postgres-3.3.1.Final-plugin.zip
            checksum: 3c411549336614c8f3e02379acfddc32aed9c4a40a66c6b28e65be5e8f588acb55420b7412235c43e462688b9694d228c9f96ccd6aa235f0ecee6ed8839048a4
  dependencies:
    kafka:
      bootstrapEndpoint: kafka:9071
---
apiVersion: platform.confluent.io/v1beta1
kind: ControlCenter
metadata:
  name: controlcenter
  namespace: confluent
spec:
  replicas: 1
  spec:
  podTemplate:
    resources:
      requests:
        cpu: "300m"
        memory: "1Gi"
      limits:
        cpu: "500m"
        memory: "1.5Gi"
  configOverrides:
    jvm:
      - "-Xms512m"
      - "-Xmx512m"

  image:
    application: confluentinc/cp-enterprise-control-center-next-gen:2.2.0
    init: confluentinc/confluent-init-container:3.1.0
  dataVolumeCapacity: 10Gi
  dependencies:
    # schemaRegistry:
    #   url: http://schemaregistry.confluent.svc.cluster.local:8081
    # ksqldb:
    # - name: ksqldb
    #   url: http://ksqldb.confluent.svc.cluster.local:8088
    connect:
    - name: connect
      url: http://connect.confluent.svc.cluster.local:8083
    kafka:
      bootstrapEndpoint: http://kafka.confluent.svc.cluster.local:9071
    prometheusClient:
      url: http://controlcenter.confluent.svc.cluster.local:9090
    alertManagerClient:
      url: http://controlcenter.confluent.svc.cluster.local:9093
  services:
    prometheus:
      image: confluentinc/cp-enterprise-prometheus:2.2.0
      pvc:
        dataVolumeCapacity: 10Gi
    alertmanager:
      image: confluentinc/cp-enterprise-alertmanager:2.2.0
# ---
# apiVersion: platform.confluent.io/v1beta1
# kind: KsqlDB
# metadata:
#   name: ksqldb
#   namespace: confluent
# spec:
#   replicas: 1
#   spec:
#   podTemplate:
#     resources:
#       requests:
#         cpu: "300m"
#         memory: "2Gi"
#       limits:
#         cpu: "500m"
#         memory: "3Gi"
#   configOverrides:
#     jvm:
#       - "-Xms1g"
#       - "-Xmx1g"

#   image:
#     application: confluentinc/cp-ksqldb-server:8.1.0
#     init: confluentinc/confluent-init-container:3.1.0
#   dataVolumeCapacity: 10Gi

# ---
# apiVersion: platform.confluent.io/v1beta1
# kind: SchemaRegistry
# metadata:
#   name: schemaregistry
#   namespace: confluent
# spec:
#   replicas: 3
#   spec:
#   podTemplate:
#     resources:
#       requests:
#         cpu: "300m"
#         memory: "2Gi"
#       limits:
#         cpu: "500m"
#         memory: "3Gi"
#   configOverrides:
#     jvm:
#       - "-Xms1g"
#       - "-Xmx1g"

#   image:
#     application: confluentinc/cp-schema-registry:8.1.0
#     init: confluentinc/confluent-init-container:3.1.0
# ---
# apiVersion: platform.confluent.io/v1beta1
# kind: KafkaRestProxy
# metadata:
#   name: kafkarestproxy
#   namespace: confluent
# spec:
#   replicas: 1
#   spec:
#   podTemplate:
#     resources:
#       requests:
#         cpu: "300m"
#         memory: "2Gi"
#       limits:
#         cpu: "500m"
#         memory: "3Gi"
#   configOverrides:
#     jvm:
#       - "-Xms1g"
#       - "-Xmx1g"

#   image:
#     application: confluentinc/cp-kafka-rest:8.1.0
#     init: confluentinc/confluent-init-container:3.1.0
#   dependencies:
#     schemaRegistry:
#       url: http://schemaregistry.confluent.svc.cluster.local:8081